<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>Vitaminados (Beta)</title>
		<meta name="author" content="kiLLeR415" />
		<link rel="shortcut icon" href="../favicon.ico">
		<link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
		<link rel="stylesheet" type="text/css" href="/assets/css/demo.css" />
		<link rel="stylesheet" type="text/css" href="/assets/css/component.css" />
		<script src="/assets/js/jquery.min.js"></script>
		<script src="/assets/js/modernizr.custom.js"></script>


		<script src="/assets/js/gauge.min.js"></script>



	
	<script>


		function createGauge(id,porc){

			var opts = {
			  lines: 12, // The number of lines to draw
			  angle: 0.5, // The length of each line
			  lineWidth: 0.1, // The line thickness
			  pointer: {
			    length: 0, // The radius of the inner circle
			    strokeWidth: 0.082, // The rotation offset
			    color: '#000000' // Fill color
			  },
			  limitMax: 'false',   // If true, the pointer will not go past the end of the gauge

			  colorStart: '#bbb',   // Colors
			  colorStop: '#bbb',    // just experiment with them
			  strokeColor: '#EFEFEF',   // to see which ones work best for you
			  generateGradient: false
			};

			var target = document.getElementById(id); // your canvas element
			var gauge = new Donut(target).setOptions(opts); // create sexy gauge!
			gauge.maxValue = 100; // set max gauge value
			gauge.animationSpeed = 1; // set animation speed (32 is default value)
			gauge.set(parseInt(target.getAttribute('name'))-1); // set actual value
			var next = target.getAttribute('name')-1;
			target.setAttribute('name',next);
		}



		$(document).ready(function () {
			

			//TODO GAUGES EN LAS VITAMINAS
			/*var value = 100;setInterval(function(){createGauge('gauge',value--);},1000)
			createGauge('gauge',50);*/


			$('.vitamina').live('click',function(e){
				$('#modal-1 h3').html(e.currentTarget.title);
				$('#modal-1 img.modal-image').attr('src',e.currentTarget.src);
				$('#modal-1 span.modal-text').load("/api/load_vitamina_desc/"+e.currentTarget.name);
				$('#modal-1 button.md-use').attr('name',e.currentTarget.id);	
			});

			$('#modal-1 button.md-use').live('click',function(e){
				$('#modal-2 h3').html('Seleccionar objetivo');
				$('#modal-2 #aplicar_vitamina').val(e.currentTarget.name);
				$('#modal-2 .md-content div').load("/api/load_targets");
				
			});

			$('#modal-2 .md-cancel').live('click',function(){
				$('.md-overlay').click();
			});

			$('#modal-2 .target').live('click',function(e){
				//TODO llamar a ejecutar vitamina (ajax)
				//alert("aplico la vitamina " + $("#aplicar_vitamina").val() + " sobre user " + e.currentTarget.childNodes[1].value);
				$.post('/api/usar_vitamina/' +$("#aplicar_vitamina").val() + "/" + e.currentTarget.childNodes[1].value,function(){
					$('.md-overlay').click();
					$('img#'+$("#aplicar_vitamina").val()).parent().hide();
					location.reload(true);
				});
				
			});

		
			// cargar todos los gauges
			$('.gauge').each(function(e,a){
				createGauge($(a).attr('id'));
				setInterval(function(){
					if (parseInt($(a).attr('name')) > 1) {
						console.log(parseInt($(a).attr('name')));
						createGauge($(a).attr('id'));
					}
					else {
						$(a).parent().hide(1000);
					}

			
				}, parseInt((($(a).attr('time'))*60)/100)*1000 )
				
			});

			//actualizar los gauges



		})
	</script>


	<style>


		.modal-image{
			float:left;
		}
		.modal-text{
			float:right;
			width: 60%;
		}

		header {
			background:white;
		}

		body {
			text-align: center;
			background: rgb(231, 76, 60);
			color: white;
		}


		.btn-2a:hover {
			box-shadow: 0 3px #A53629;
			top: 2px;
		}
		.btn-2a {
			border-radius: 0 0 5px 5px;
		}
		.btn-2 {
			background: #CD4436;
			color: #fff;
			box-shadow: 0 6px #A53629;
			-webkit-transition: none;
			-moz-transition: none;
			transition: none;
		}
		.btn {
			border: none;
			font-family: inherit;
			font-size: inherit;
			cursor: pointer;
			padding: 25px 80px;
			display: inline-block;
			margin: 15px 30px;
			text-transform: uppercase;
			letter-spacing: 1px;
			font-weight: 700;
			outline: none;
			position: relative;
			-webkit-transition: all 0.3s;
			-moz-transition: all 0.3s;
			transition: all 0.3s;
			text-decoration:none;
		}


		.md-content button {
		display: inline-block;
		margin: 3px;
		font-size: 0.8em;
		padding: 12px;
		margin-top: 27px;
		}


		button {
			border: none;
			border-image-source: initial;
			border-image-slice: initial;
			border-image-width: initial;
			border-image-outset: initial;
			border-image-repeat: initial;
			padding: 0.6em 1.2em;
			background: #A1B412;
			color: rgb(255, 255, 255);
			font-family: Lato, Calibri, Arial, sans-serif;
			font-size: 1em;
			letter-spacing: 1px;
			text-transform: uppercase;
			cursor: pointer;
			display: inline-block;
			margin: 3px 2px;
			border-radius: 2px;
		}

		#nick_input,#login_input{
			padding: 8px;
			width: 444px;
			display: block;
			margin: auto;
			margin-top: 15px;
		}
		#cerrar_session {
			position:absolute;
			top: 0px;
			left: 0px;
			color:#666;
			font-size: 14px;
		}
		.cl-effect-6 a::before {
			background: #666;
		}

		#form_juego {
			width:49%;
			float:left;
		}

		#info_juego {
			width:49%;
			float:right;
			text-align: left;
			padding:50px;
		}

		#info_juego .ficha-titulo{
			font-size: 30px;
			margin: 20px;
		}

		#info_juego .ficha-img {
			position: absolute;
			right: 0px;
			margin-right: 19px;
			width: 166px;
			border-radius: 81px;
			border: 8px solid tomato;
			padding: 9px;
		}

		.ficha {
			position: relative;
			height: 146px;
		}


		#vitaminero , #efectos{
			background: #EFEFEF;
			color: #666;
			padding: 27px;
			margin: 8px 20px;
			font-size: 26px;
			border: 5px solid #fff;
		}

		.vitamina {
			border-radius: 49px;
			padding: 5px;
			width: 57px;
			cursor:pointer;
			position: relative;
			left: -104px;
			top: -6px;
		}

		.vitamina.cat1 {
			border: 5px solid tomato;
		}
		.vitamina.cat2 {
			border: 5px solid #FCC05A;	
		}
		.vitamina.cat3 {
			border: 5px solid #7ECFA7;
		}

		.vitaminapack {
			width: 98px;
			display: inline-block;
			white-space: nowrap;
			position: relative;
			left: -38px;
		}

		.gauge{
			width: 137px;
			height: 69px;	
		}


		/* modal */

#modal-2 .md-content {
height: 600px;
overflow-y: auto;
overflow-x: hidden;
}

.target:hover {
background: #E5FF19;
color: #444;
}

.target {
cursor: pointer;
position: relative;
display: inline-block;
width: 122PX;
padding: 11px;
margin: 2px 4px;
background: #B7CB14;
padding-left: 30px;
padding-top: 14px;
}

.target img {
float: left;
margin-top: 13px;
border-radius: 35px;
border: solid 3px #E5FF19;
}

.target .target-nick {
float: left;
clear: left;
margin-top: 3px;
margin-bottom: -6px;
font-size: 13px;
white-space: nowrap;
}

.target .target-puntos {
position: absolute;
top: 0px;
right: 0px;
padding: 0px 10px;
white-space: nowrap;
border-top: solid 6px #E5FF19;
}

.target .target-racha {
position: absolute;
bottom: 24px;
background: #CDE707;
border-radius: 30px;
padding: 4px;
color: #444;
font-size: 12px;
left: 69px;
}

.target-logo {
border: 0px !important;
width: 30px;
position: absolute;
bottom: 2px;
left: 0px;
}

#dimmok {
margin-left: 165px;
}
	</style>



	{% block head %}{% endblock %}
	</head>

	<body>
		<div class="container">
			<!-- Top Navigation -->
			<div class="codrops-top clearfix">
				
			</div>
			<header>
				{% if logueado %}
					<nav class="cl-effect-6" id="cl-effect-6">
						<a id="cerrar_session" href="/login/out">Cerrar Sessión</a>
					</nav>
				{% endif %}
				<h1>Vitaminados (Beta) <span>Un juego para putear a los demás y putearte tu mismo.</span></h1>
				<p>Jugar con moderación, el grado de enfermedad puede ser épico.</p>
			</header>
			<section class="color-5">
				<nav class="cl-effect-4">
					<a style="font-size:16px" href="/info">¿Cómo se juega!?</a>
					<a style="font-size:16px" href="/info/ranking">¿Quién va ganando?</a>
					<a style="font-size:30px" href="/jugar">¡Jugar!</a>
					<a style="font-size:16px" href="/info/developer">¿Quien ha hecho esta mierda?</a>
					<a style="font-size:16px" href="/info/premios">Premios</a>
				</nav>
			</section>

			{% block content %}{% endblock %}
		</div>



		<div class="md-overlay"></div><!-- the overlay element -->

		<!-- classie.js by @desandro: https://github.com/desandro/classie -->
		<script src="/assets/js/classie.js"></script>
		<script src="/assets/js/modalEffects.js"></script>

		<!-- for the blur effect -->
		<!-- by @derSchepp https://github.com/Schepp/CSS-Filters-Polyfill -->
		<script>
			// this is important for IEs
			var polyfilter_scriptpath = '/assets/js/';
		</script>
		<script src="/assets/js/cssParser.js"></script>
		<script src="/assets/js/css-filters-polyfill.js"></script>

	</body>

</html>